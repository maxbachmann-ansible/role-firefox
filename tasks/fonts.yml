---
- name: create font directory
  become: true
  file:
    state: directory
    path: "/usr/share/fonts/ansible-fonts"

- name: download fonts
  become: true
  get_url:
    url: "{{ item }}"
    dest: "/usr/share/fonts/ansible-fonts"
  with_items: "{{ fonts_list }}"
  retries: 5
  delay: 2
  register: addon_result
  until: addon_result is succeeded
  notify: install fonts

- name: Install fonts
  become: true
  package:
    name: "{{ packages }}"
    state: present
    update_cache: true
  vars:
    packages:
      - "{{ ansible_distribution }}_package_fonts"
      - fontconfig
  retries: 5
  delay: 2
  register: font_result
  until: font_result is succeeded



